I"	<h3 id="hyperloglog简介">HyperLogLog简介</h3>
<p><a href="https://redis.io/topics/data-types-intro">Redis HyperLogLog</a>(以下简称HLL)实现了一种叫做“HyperLogLog”的算法，并以Redis数据结构的形式提供给开发者使用。HLL只做一件事情，即统计集合中不重复元素的个数（术语叫做集合基数）。<br />
集合基数的统计用Redis中的set数据结构和Java中的Set集合类都可以实现，但是由于它们都会实际存储集合元素——存储空间正比于集合基数，因此它们不适合集合基数比较大的场景。HLL使用“精度换空间”的权衡策略，实现了以12kB的常量存储空间开销，得到标准误（standard error）为0.81%的集合基数估计值，并且集合基数的上限可以达到2^64。HyperLogLog不存储集合元素，只存储一个反映已添加集合元素的状态。<br />
Redis HLL在实现上没有引入新的数据结构，而是复用了string数据结构，即HLL底层是用string编码的。</p>

<h4 id="使用场景举例">使用场景举例</h4>
<p>服务每天被多少个不重复的IP访问过？<br />
接口每月被多少个不重复的用户ID访问过？<br />
搜索每天接收到了多少个不重复的搜索词请求？</p>

<h3 id="hyperloglog命令">HyperLogLog命令</h3>
<p>HLL的API非常简单，包括3条命令：</p>

<table>
  <thead>
    <tr>
      <th>command</th>
      <th>作用</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>PFADD</td>
      <td>往HLL添加元素</td>
    </tr>
    <tr>
      <td>PFCOUNT</td>
      <td>读取HLL当前集合基数</td>
    </tr>
    <tr>
      <td>PFMERGE</td>
      <td>合并两个或多个HLL</td>
    </tr>
  </tbody>
</table>

<h4 id="pfadd-往hll添加元素">PFADD: 往HLL添加元素</h4>
<p>PFADD key [element [element …]]</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redis&gt;  PFADD hll a b c d e f g
<span class="o">(</span>integer<span class="o">)</span> 1
redis&gt;  PFCOUNT hll
<span class="o">(</span>integer<span class="o">)</span> 7
</code></pre></div></div>
<p><strong>返回值</strong><br />
Integer reply, specifically:<br />
　　1 if at least 1 HyperLogLog internal register was altered. 0 otherwise.<br />
<strong>时间复杂度</strong><br />
O(1)时间复杂度</p>

<h3 id="hyperloglog原理">HyperLogLog原理</h3>

<hr />

<p>参考：<br />
《Linux Shell脚本攻略》</p>

:ET